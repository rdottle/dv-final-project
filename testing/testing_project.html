<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Cloropleth map</title>
  </head>

  <style type="text/css">
    /*CSS goes here */
  </style>
  
  <body>
    <!-- page elements go here -->
    <!-- side panel -->
    <div class="sidePanel">
      <div class = "container" >
        <div class="row">
          <div class="col-md-2">
            <!-- heading -->
            <h1> FILTER </h1>
            <!-- list of tags to select  -->
            <ul class="selections">
              <li class="topHeading">Price</li>
              <li><input class="updateButton" id="affordablefrequency" type="button" value="Affordable"></li>             
              <li><input class="updateButton" id="luxuryfrequency" type="button" value="Luxury"></li> 
            </ul>

            <ul class="selections">
              <li class="topHeading">Interior</li>
              <li><input class="updateButton" id="cozyfrequency" type="button" value="Cozy"></li> 
              <li><input class="updateButton" id="modernfrequency" type="button" value="Modern"></li>            
            </ul>

            <ul class="selections">
              <li class="topHeading">Identity</li>
              <li><input class="updateButton" id="diversefrequency" type="button" value="Diverse"></li> 
              <li><input class="updateButton" id="hipsterfrequency" type="button" value="Hipster"></li> 
              <li><input class="updateButton" id="historicfrequency" type="button" value="Historic"></li> 
            </ul>

            <ul class="selections">
              <li class="topHeading">Neighborhood Amenities</li>
              <li><input class="updateButton" id="barfrequency" type="button" value="Bar"></li> 
              <li><input class="updateButton" id="parkfrequency" type="button" value="Park"></li> 
            </ul>

            <ul class="selections">
              <li class="topHeading">Pace</li>
              <li><input class="updateButton" id="quietfrequency" type="button" value="Quiet"></li> 
              <li><input class="updateButton" id="busyfrequency" type="button" value="Busy"></li> 
            </ul>
          </div>
        </div>
      </div>
    </div>
    
    <div class="bodyPanel">
      <div class = "container" >
        <div class="row">
          <div class="col-md-10">
            <svg class="chloroplethMap" width = "680" height = "600"> </svg>
              <div class="col-md-6">
            <svg class="reviewsMap" width = "480" height = "600"> </svg>
          </div>
          <div class="col-md-6">
            <svg class="listingsMap" width = "480" height = "600"> </svg>
          </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </body>
<!--  links  to bootstrap and d3 and stylesheet-->
  <script src="http://d3js.org/d3.v4.min.js"></script>
  <script src="http://d3js.org/d3-queue.v3.min.js"></script>  
  <script src="http://d3js.org/topojson.v1.min.js"></script>    

  <!-- Stylesheet + Bootstrap link -->
  <!-- <link href="css/bootstrap.min.css" rel="stylesheet">  -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">  
  <link rel="stylesheet" type="text/css" href="testing_NTA.css">
  <link rel="stylesheet" type="text/css" href="../css/site-specific.css">

  <script type="text/javascript">

//map basics
  //using svg element to display the map on 
  var width = 960;
      height = 600;

  //for all maps
  var projection = d3.geoMercator()
      .center([-73.94, 40.70])
      .scale(42000)
      .translate([width / 4, height / 2]); 
  var path = d3.geoPath()
      .projection(projection);

  //just for first map 
  var projectionIntro = d3.geoMercator()
      .center([-73.94, 40.70])
      .scale(55000)
      .translate([width / 2 -50, height / 2 ]); 
  var pathIntro = d3.geoPath()
      .projection(projectionIntro);

  //sets/creates svg window and draws first NYC map  
  var svg = d3.select(".chloroplethMap").append("svg")
      .attr("width", width)
      .attr("height", height)

  //creates svg window for reviews and listings maps 
  var svgReviews = d3.select(".reviewsMap").append("svg")
      .attr("width", width)
      .attr("height", height)
  var svgListings = d3.select(".listingsMap").append("svg")
      .attr("width", width)
      .attr("height", height)

//setting colors for maps
  var lowColor = "#ffffff"
  var highColorPrice = "#06063B"
  var highColorInterior = "#330003"
  var highColorIdentity = "#100026"
  var highColorAmenities = "#220024"
  var highColorPace = "#570E0E"

 //REVIEWS 
  var colorPriceAffordable = d3.scaleLinear()
    .domain([0, 0.407608696])
    .range([lowColor, highColorPrice])
  var colorPriceLuxury = d3.scaleLinear()
    .domain([0, 0.201612903])
    .range([lowColor, highColorPrice])

  var colorInteriorCozy = d3.scaleLinear()
    .domain([0, 1.52284264])
    .range([lowColor, highColorInterior])
  var colorInteriorModern = d3.scaleLinear()
    .domain([0, 0.337837838])
    .range([lowColor, highColorInterior])

  var colorIdentityDiverse = d3.scaleLinear()
    .domain([0, 0.200722601])
    .range([lowColor, highColorIdentity])
  var colorIdentityHipster = d3.scaleLinear()
    .domain([0, 0.10384216])
    .range([lowColor, highColorIdentity])
  var colorIdentityHistoric = d3.scaleLinear()
    .domain([0, 0.063417728])
    .range([lowColor, highColorIdentity])

  var colorAmenitiesBar = d3.scaleLinear()
    .domain([0, 5.555555556])
    .range([lowColor, highColorAmenities])
  var colorAmenitiesPark = d3.scaleLinear()
    .domain([0, 2.030456853])
    .range([lowColor, highColorAmenities])

  var colorPaceQuiet = d3.scaleLinear()
    .domain([0, 1.411290323])
    .range([lowColor, highColorPace])
  var colorPaceBusy = d3.scaleLinear()
    .domain([0, 0.21905805])
    .range([lowColor, highColorPace])

  d3.queue()  
      .defer(d3.json, "boroughs_NTA.json")
      .defer(d3.csv, "nta_updated_reviews_listings.csv") 
      .await(ready); //Run 'ready' when JSONs are loaded

function ready(error, nyc, frequency) { //error, var1, var2
    if (error) throw error;
    console.log(nyc)
    console.log(frequency)
  //variables
    //reviews
    var affordableFreq = {};
    var barFreq = {};
    var busyFreq = {};
    var cozyFreq = {};
    var diverseFreq = {};
    var hipsterFreq = {};
    var historicFreq = {};
    var luxuryFreq = {};
    var modernFreq = {};
    var parkFreq = {};
    var quietFreq = {};
    //listings
    var affordableListFreq = {};
    var barListFreq = {};
    var busyListFreq = {};
    var cozyListFreq = {};
    var diverseListFreq = {};
    var hipsterListFreq = {};
    var historicListFreq = {};
    var luxuryListFreq = {};
    var modernListFreq = {};
    var parkListFreq = {};
    var quietListFreq = {};
    
    frequency.forEach(function(d) {
      //these are for reviews
      affordableFreq[d.ntacode] = +d.affordablefreq; 
      barFreq[d.ntacode] = +d.barfreq;
      busyFreq[d.ntacode] = +d.busyfreq;
      cozyFreq[d.ntacode] = +d.cozyfreq;
      diverseFreq[d.ntacode] = +d.diversefreq;
      hipsterFreq[d.ntacode] = +d.hipsterfreq;
      historicFreq[d.ntacode] = +d.historicfreq;
      luxuryFreq[d.ntacode] = +d.luxuryfreq;
      modernFreq[d.ntacode] = +d.modernfreq;
      parkFreq[d.ntacode] = +d.parkfreq;
      quietFreq[d.ntacode] = +d.quietfreq;
      //these are for listings
      affordableListFreq[d.ntacode] = +d.affordablelistfreq; 
      barListFreq[d.ntacode] = +d.barlistfreq;
      busyListFreq[d.ntacode] = +d.busylistfreq;
      cozyListFreq[d.ntacode] = +d.cozylistfreq;
      diverseListFreq[d.ntacode] = +d.diverselistfreq;
      hipsterListFreq[d.ntacode] = +d.hipsterlistfreq;
      historicListFreq[d.ntacode] = +d.historiclistfreq;
      luxuryListFreq[d.ntacode] = +d.luxurylistfreq;
      modernListFreq[d.ntacode] = +d.modernlistfreq;
      parkListFreq[d.ntacode] = +d.parklistfreq;
      quietListFreq[d.ntacode] = +d.quietlistfreq;
      // console.log(affordableFreq)
    });
    
  //drawing intro map 
   d3.select("svg.chloroplethMap")
   .selectAll("path")
    .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
   .enter().append("path")
    .attr("d", pathIntro)
    .style("fill", "gold")
    .style("fill-opacity", "0.2")
   svg.append("text")
    .attr("class", "NYCtitle")
    .attr("x", 400)
    .attr("y", function(d){ return height / 10;}) 
    .text("New York City")
    //adding borough titles 
   svg.append("text")
    .attr("class", "boroughName")
    .attr("x", width/3 - 10)
    .attr("y", function(d){ return height * 60 /180;}) 
    .text("Manhattan")
   svg.append("text")
    .attr("class", "boroughName")
    .attr("x", width/2 - 40)
    .attr("y", function(d){ return height * 90 / 150;}) 
    .text("Brooklyn")
   svg.append("text")
    .attr("class", "boroughName")
    .attr("x", width/2 + 80)
    .attr("y", function(d){ return height * 70 / 150;})
    .text("Queens") 
   svg.append("text")
    .attr("class", "boroughName")
    .attr("x", width/2 + 30)
    .attr("y", function(d){ return height * 60 / 300;}) 
    .text("The Bronx")
   svg.append("text")
    .attr("class", "boroughName")
    .attr("x", width/7 + 5)
    .attr("y", function(d){ return height * 210 / 300;}) 
    .text("Staten Island")
   //adding outline for borough boundaries [INTRO]
   svg.append("path")
    .datum(topojson.mesh(nyc, nyc.objects.nybb))
    .attr("class", "boroughs") 
    .attr("d", pathIntro)
    .style("stroke", "gold")
    .style("stroke-width", "1")
    .style("stroke-opacity", "1")

// Add mouse events
    d3.select("#affordablefrequency").on("click", affordablefrequency);
      function affordablefrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true); //classed adds new class here
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g") //appending it to the left map 
        .attr("class", "nta") 
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorPriceAffordable(affordableFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
        //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
         svgReviews.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
        //adding outline for borough boundaries [LISTINGS]
         svgListings.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
        //drawing legend for chloropleth
        var w = 960, h = 625; //width and height of legend 

        var key = d3.select("body")
          .append("svg")
          .attr("width", w)
          .attr("height", h)
          .attr("class", "legend");

        var legend = key.append("defs")
          .append("svg:linearGradient")
          .attr("id", "gradient")
          .attr("x1", "100%")
          .attr("y1", "100%")
          .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
          .attr("y2", "100%")
          .attr("spreadMethod", "pad");
        //stop color
        legend.append("stop")
          .attr("offset", "0%")
          .attr("stop-color", highColorPrice)
          .attr("stop-opacity", 1);
        //start color
        legend.append("stop")
          .attr("offset", "100%")
          .attr("stop-color", lowColor)
          .attr("stop-opacity", 1);

        key.append("rect")
          .attr("width", 200) //width and height of rectangle 
          .attr("height", 20)
          .style("fill", "url(#gradient)")
          .attr("transform", "translate(220, 570)"); //changes the position
        
        key.append("text")
          .attr("class", "legendText") 
          .attr("x", 220) 
          .attr("y", 605) 
          .text("Low");

        key.append("text")
          .attr("class", "legendText") 
          .attr("x", 390) 
          .attr("y", 605) 
          .text("High");

        key.append("text")
          .attr("class", "legendHeading")
          .attr("x", 220)
          .attr("y", 560) 
          .text("Relative Frequency")

        //adding source
        key.append("text")
          .attr("class", "sourceText")
          .attr("x", 220)
          .attr("y", 618) 
          .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
          }
    d3.select("#luxuryfrequency").on("click", luxuryfrequency);
      function luxuryfrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true); 
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g")
        .attr("class", "nta") 
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorPriceLuxury(luxuryFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
       //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
         svgReviews.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
        //adding outline for borough boundaries [LISTINGS]
         svgListings.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
          //drawing legend for chloropleth
          var w = 960, h = 625; //width and height of legend 

          var key = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h)
            .attr("class", "legend");

          var legend = key.append("defs")
            .append("svg:linearGradient")
            .attr("id", "gradient")
            .attr("x1", "100%")
            .attr("y1", "100%")
            .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
            .attr("y2", "100%")
            .attr("spreadMethod", "pad");
          //stop color
          legend.append("stop")
            .attr("offset", "0%")
            .attr("stop-color", highColorPrice)
            .attr("stop-opacity", 1);
          //start color
          legend.append("stop")
            .attr("offset", "100%")
            .attr("stop-color", lowColor)
            .attr("stop-opacity", 1);

          key.append("rect")
            .attr("width", 200) //width and height of rectangle 
            .attr("height", 20)
            .style("fill", "url(#gradient)")
            .attr("transform", "translate(220, 570)"); //changes the position
          
          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 220) 
            .attr("y", 605) 
            .text("Low");

          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 390) 
            .attr("y", 605) 
            .text("High");

          key.append("text")
            .attr("class", "legendHeading")
            .attr("x", 220)
            .attr("y", 560) 
            .text("Relative Frequency")

          //adding source
          key.append("text")
            .attr("class", "sourceText")
            .attr("x", 220)
            .attr("y", 618) 
            .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
            }

    d3.select("#modernfrequency").on("click", modernfrequency);
      function modernfrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g")
        .attr("class", "nta") 
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorInteriorModern(modernFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
        //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
         svgReviews.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
        //adding outline for borough boundaries [LISTINGS]
         svgListings.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
          //drawing legend for chloropleth
          var w = 960, h = 625; //width and height of legend 

          var key = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h)
            .attr("class", "legend");

          var legend = key.append("defs")
            .append("svg:linearGradient")
            .attr("id", "gradient")
            .attr("x1", "100%")
            .attr("y1", "100%")
            .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
            .attr("y2", "100%")
            .attr("spreadMethod", "pad");
          //stop color
          legend.append("stop")
            .attr("offset", "0%")
            .attr("stop-color", highColorInterior)
            .attr("stop-opacity", 1);
          //start color
          legend.append("stop")
            .attr("offset", "100%")
            .attr("stop-color", lowColor)
            .attr("stop-opacity", 1);

          key.append("rect")
            .attr("width", 200) //width and height of rectangle 
            .attr("height", 20)
            .style("fill", "url(#gradient)")
            .attr("transform", "translate(220, 570)"); //changes the position
          
          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 220) 
            .attr("y", 605) 
            .text("Low");

          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 390) 
            .attr("y", 605) 
            .text("High");

          key.append("text")
            .attr("class", "legendHeading")
            .attr("x", 220)
            .attr("y", 560) 
            .text("Relative Frequency")

          //adding source
          key.append("text")
            .attr("class", "sourceText")
            .attr("x", 220)
            .attr("y", 618) 
            .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
            }
    d3.select("#cozyfrequency").on("click", cozyfrequency);
      function cozyfrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g")
        .attr("class", "nta") //i define the class 
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorInteriorCozy(cozyFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
        //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
        svgReviews.append("path")
        .datum(topojson.mesh(nyc, nyc.objects.nybb))
        .attr("class", "boroughs") 
        .attr("d", path)
        //adding outline for borough boundaries [LISTINGS]
        svgListings.append("path")
        .datum(topojson.mesh(nyc, nyc.objects.nybb))
        .attr("class", "boroughs") 
        .attr("d", path)
        //drawing legend for chloropleth
        var w = 960, h = 625; //width and height of legend 

        var key = d3.select("body")
          .append("svg")
          .attr("width", w)
          .attr("height", h)
          .attr("class", "legend");

        var legend = key.append("defs")
          .append("svg:linearGradient")
          .attr("id", "gradient")
          .attr("x1", "100%")
          .attr("y1", "100%")
          .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
          .attr("y2", "100%")
          .attr("spreadMethod", "pad");
        //stop color
        legend.append("stop")
          .attr("offset", "0%")
          .attr("stop-color", highColorInterior)
          .attr("stop-opacity", 1);
        //start color
        legend.append("stop")
          .attr("offset", "100%")
          .attr("stop-color", lowColor)
          .attr("stop-opacity", 1);

        key.append("rect")
          .attr("width", 200) //width and height of rectangle 
          .attr("height", 20)
          .style("fill", "url(#gradient)")
          .attr("transform", "translate(220, 570)"); //changes the position
        
        key.append("text")
          .attr("class", "legendText") 
          .attr("x", 220) 
          .attr("y", 605) 
          .text("Low");

        key.append("text")
          .attr("class", "legendText") 
          .attr("x", 390) 
          .attr("y", 605) 
          .text("High");

        key.append("text")
          .attr("class", "legendHeading")
          .attr("x", 220)
          .attr("y", 560) 
          .text("Relative Frequency")

        //adding source
        key.append("text")
          .attr("class", "sourceText")
          .attr("x", 220)
          .attr("y", 618) 
          .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
          }

    d3.select("#diversefrequency").on("click", diversefrequency);
      function diversefrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g")
        .attr("class", "nta") 
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorIdentityDiverse(diverseFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
        //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
        svgReviews.append("path")
        .datum(topojson.mesh(nyc, nyc.objects.nybb))
        .attr("class", "boroughs") 
        .attr("d", path)
        .style("stroke", "grey")
        .style("stroke-width", "1")
        .style("stroke-opacity", "1")
        //adding outline for borough boundaries [LISTINGS]
        svgListings.append("path")
        .datum(topojson.mesh(nyc, nyc.objects.nybb))
        .attr("class", "boroughs") 
        .attr("d", path)
        .style("stroke", "grey")
        .style("stroke-width", "1")
        .style("stroke-opacity", "1")
          //drawing legend for chloropleth
        var w = 960, h = 625; //width and height of legend 

        var key = d3.select("body")
          .append("svg")
          .attr("width", w)
          .attr("height", h)
          .attr("class", "legend");

        var legend = key.append("defs")
          .append("svg:linearGradient")
          .attr("id", "gradient")
          .attr("x1", "100%")
          .attr("y1", "100%")
          .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
          .attr("y2", "100%")
          .attr("spreadMethod", "pad");
        //stop color
        legend.append("stop")
          .attr("offset", "0%")
          .attr("stop-color", highColorIdentity)
          .attr("stop-opacity", 1);
        //start color
        legend.append("stop")
          .attr("offset", "100%")
          .attr("stop-color", lowColor)
          .attr("stop-opacity", 1);

        key.append("rect")
          .attr("width", 200) //width and height of rectangle 
          .attr("height", 20)
          .style("fill", "url(#gradient)")
          .attr("transform", "translate(220, 570)"); //changes the position
        
        key.append("text")
          .attr("class", "legendText") 
          .attr("x", 220) 
          .attr("y", 605) 
          .text("Low");

        key.append("text")
          .attr("class", "legendText") 
          .attr("x", 390) 
          .attr("y", 605) 
          .text("High");

        key.append("text")
          .attr("class", "legendHeading")
          .attr("x", 220)
          .attr("y", 560) 
          .text("Relative Frequency")

        //adding source
        key.append("text")
          .attr("class", "sourceText")
          .attr("x", 220)
          .attr("y", 618) 
          .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
          }
    d3.select("#hipsterfrequency").on("click", hipsterfrequency);
      function hipsterfrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g")
        .attr("class", "nta") 
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorIdentityHipster(hipsterFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
        //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
         svgReviews.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
          .style("stroke", "grey")
          .style("stroke-width", "1")
          .style("stroke-opacity", "1")
        //adding outline for borough boundaries [LISTINGS]
         svgListings.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
          .style("stroke", "grey")
          .style("stroke-width", "1")
          .style("stroke-opacity", "1")
          //drawing legend for chloropleth
          var w = 960, h = 625; //width and height of legend 

          var key = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h)
            .attr("class", "legend");

          var legend = key.append("defs")
            .append("svg:linearGradient")
            .attr("id", "gradient")
            .attr("x1", "100%")
            .attr("y1", "100%")
            .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
            .attr("y2", "100%")
            .attr("spreadMethod", "pad");
          //stop color
          legend.append("stop")
            .attr("offset", "0%")
            .attr("stop-color", highColorIdentity)
            .attr("stop-opacity", 1);
          //start color
          legend.append("stop")
            .attr("offset", "100%")
            .attr("stop-color", lowColor)
            .attr("stop-opacity", 1);

          key.append("rect")
            .attr("width", 200) //width and height of rectangle 
            .attr("height", 20)
            .style("fill", "url(#gradient)")
            .attr("transform", "translate(220, 570)"); //changes the position
          
          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 220) 
            .attr("y", 605) 
            .text("Low");

          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 390) 
            .attr("y", 605) 
            .text("High");

          key.append("text")
            .attr("class", "legendHeading")
            .attr("x", 220)
            .attr("y", 560) 
            .text("Relative Frequency")

          //adding source
          key.append("text")
            .attr("class", "sourceText")
            .attr("x", 220)
            .attr("y", 618) 
            .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
            }
    d3.select("#historicfrequency").on("click", historicfrequency);
      function historicfrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g")
        .attr("class", "nta") 
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorIdentityHistoric(historicFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
        //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
        svgReviews.append("path")
        .datum(topojson.mesh(nyc, nyc.objects.nybb))
        .attr("class", "boroughs") 
        .attr("d", path)
        .style("stroke", "grey")
        .style("stroke-width", "1")
        .style("stroke-opacity", "1")
        //adding outline for borough boundaries [LISTINGS]
        svgListings.append("path")
        .datum(topojson.mesh(nyc, nyc.objects.nybb))
        .attr("class", "boroughs") 
        .attr("d", path)
        .style("stroke", "grey")
        .style("stroke-width", "1")
        .style("stroke-opacity", "1")
        //drawing legend for chloropleth
        var w = 960, h = 625; //width and height of legend 

        var key = d3.select("body")
          .append("svg")
          .attr("width", w)
          .attr("height", h)
          .attr("class", "legend");

        var legend = key.append("defs")
          .append("svg:linearGradient")
          .attr("id", "gradient")
          .attr("x1", "100%")
          .attr("y1", "100%")
          .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
          .attr("y2", "100%")
          .attr("spreadMethod", "pad");
        //stop color
        legend.append("stop")
          .attr("offset", "0%")
          .attr("stop-color", highColorIdentity)
          .attr("stop-opacity", 1);
        //start color
        legend.append("stop")
          .attr("offset", "100%")
          .attr("stop-color", lowColor)
          .attr("stop-opacity", 1);

        key.append("rect")
          .attr("width", 200) //width and height of rectangle 
          .attr("height", 20)
          .style("fill", "url(#gradient)")
          .attr("transform", "translate(220, 570)"); //changes the position
        
        key.append("text")
          .attr("class", "legendText") 
          .attr("x", 220) 
          .attr("y", 605) 
          .text("Low");

        key.append("text")
          .attr("class", "legendText") 
          .attr("x", 390) 
          .attr("y", 605) 
          .text("High");

        key.append("text")
          .attr("class", "legendHeading")
          .attr("x", 220)
          .attr("y", 560) 
          .text("Relative Frequency")

        //adding source
        key.append("text")
          .attr("class", "sourceText")
          .attr("x", 220)
          .attr("y", 618) 
          .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
          }

    d3.select("#barfrequency").on("click", barfrequency);
      function barfrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g")
        .attr("class", "nta") //i define the class 
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) // Bind TopoJSON data elements - this has to be basically the name of the file under the objects in the json 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorAmenitiesBar(barFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
        //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
         svgReviews.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
        //adding outline for borough boundaries [LISTINGS]
         svgListings.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
          //drawing legend for chloropleth
          var w = 960, h = 625; //width and height of legend 

          var key = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h)
            .attr("class", "legend");

          var legend = key.append("defs")
            .append("svg:linearGradient")
            .attr("id", "gradient")
            .attr("x1", "100%")
            .attr("y1", "100%")
            .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
            .attr("y2", "100%")
            .attr("spreadMethod", "pad");
          //stop color
          legend.append("stop")
            .attr("offset", "0%")
            .attr("stop-color", highColorAmenities)
            .attr("stop-opacity", 1);
          //start color
          legend.append("stop")
            .attr("offset", "100%")
            .attr("stop-color", lowColor)
            .attr("stop-opacity", 1);

          key.append("rect")
            .attr("width", 200) //width and height of rectangle 
            .attr("height", 20)
            .style("fill", "url(#gradient)")
            .attr("transform", "translate(220, 570)"); //changes the position
          
          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 220) 
            .attr("y", 605) 
            .text("Low");

          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 390) 
            .attr("y", 605) 
            .text("High");

          key.append("text")
            .attr("class", "legendHeading")
            .attr("x", 220)
            .attr("y", 560) 
            .text("Relative Frequency")

          //adding source
          key.append("text")
            .attr("class", "sourceText")
            .attr("x", 220)
            .attr("y", 618) 
            .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
            }
    d3.select("#parkfrequency").on("click", parkfrequency);
      function parkfrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g")
        .attr("class", "nta") 
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorAmenitiesPark(parkFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
        //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
         svgReviews.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
        //adding outline for borough boundaries [LISTINGS]
         svgListings.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
          //drawing legend for chloropleth
          var w = 960, h = 625; //width and height of legend 

          var key = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h)
            .attr("class", "legend");

          var legend = key.append("defs")
            .append("svg:linearGradient")
            .attr("id", "gradient")
            .attr("x1", "100%")
            .attr("y1", "100%")
            .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
            .attr("y2", "100%")
            .attr("spreadMethod", "pad");
          //stop color
          legend.append("stop")
            .attr("offset", "0%")
            .attr("stop-color", highColorAmenities)
            .attr("stop-opacity", 1);
          //start color
          legend.append("stop")
            .attr("offset", "100%")
            .attr("stop-color", lowColor)
            .attr("stop-opacity", 1);

          key.append("rect")
            .attr("width", 200) //width and height of rectangle 
            .attr("height", 20)
            .style("fill", "url(#gradient)")
            .attr("transform", "translate(220, 570)"); //changes the position
          
          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 220) 
            .attr("y", 605) 
            .text("Low");

          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 390) 
            .attr("y", 605) 
            .text("High");

          key.append("text")
            .attr("class", "legendHeading")
            .attr("x", 220)
            .attr("y", 560) 
            .text("Relative Frequency")

          //adding source
          key.append("text")
            .attr("class", "sourceText")
            .attr("x", 220)
            .attr("y", 618) 
            .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
            }

    d3.select("#quietfrequency").on("click", quietfrequency);
      function quietfrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g")
        .attr("class", "nta") 
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorPaceQuiet(quietFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
        //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
         svgReviews.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
        //adding outline for borough boundaries [LISTINGS]
         svgListings.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
        //drawing legend for chloropleth
        var w = 960, h = 625; //width and height of legend 

        var key = d3.select("body")
          .append("svg")
          .attr("width", w)
          .attr("height", h)
          .attr("class", "legend");

        var legend = key.append("defs")
          .append("svg:linearGradient")
          .attr("id", "gradient")
          .attr("x1", "100%")
          .attr("y1", "100%")
          .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
          .attr("y2", "100%")
          .attr("spreadMethod", "pad");
        //stop color
        legend.append("stop")
          .attr("offset", "0%")
          .attr("stop-color", highColorPace)
          .attr("stop-opacity", 1);
        //start color
        legend.append("stop")
          .attr("offset", "100%")
          .attr("stop-color", lowColor)
          .attr("stop-opacity", 1);

        key.append("rect")
          .attr("width", 200) //width and height of rectangle 
          .attr("height", 20)
          .style("fill", "url(#gradient)")
          .attr("transform", "translate(220, 570)"); //changes the position
        
        key.append("text")
          .attr("class", "legendText") 
          .attr("x", 220) 
          .attr("y", 605) 
          .text("Low");

        key.append("text")
          .attr("class", "legendText") 
          .attr("x", 390) 
          .attr("y", 605) 
          .text("High");

        key.append("text")
          .attr("class", "legendHeading")
          .attr("x", 220)
          .attr("y", 560) 
          .text("Relative Frequency")

        //adding source
        key.append("text")
          .attr("class", "sourceText")
          .attr("x", 220)
          .attr("y", 618) 
          .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
          }
    d3.select("#busyfrequency").on("click", busyfrequency);
      function busyfrequency(d){
        //this changes the styling of the selected button 
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);
        //to clear these elements when you change the map 
        d3.select(".chloroplethMap").remove();
        d3.selectAll(".boroughs").remove();
        d3.selectAll(".mapTitle").remove();
        d3.select(".legend").remove();
      svgReviews.append("g")
        .attr("class", "nta")  
       .selectAll("path")
        .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
       .enter().append("path")
        .attr("d", path)
        .style("fill", function(d) {
          return colorPaceBusy(busyFreq[d.properties.ntacode]);
        })
        .style("stroke", "lightgrey")
        .style("stroke-width", "0.2")
        //drawing reviews and listings headings 
        d3.select("svg.reviewsMap")   
          svgReviews.append("text")
          .attr("class", "mapTitle")
          .attr("x", 20)
          .attr("y", 40) 
          .text("AirBnB Reviews")
        d3.select("svg.listingsMap")
          svgListings.append("text")
          .attr("class", "mapTitle")
          .attr("x", 80)
          .attr("y", 40) 
          .text("Air BnB Listings")
        //adding outline for borough boundaries [REVIEWS]
         svgReviews.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
        //adding outline for borough boundaries [LISTINGS]
         svgListings.append("path")
          .datum(topojson.mesh(nyc, nyc.objects.nybb))
          .attr("class", "boroughs") 
          .attr("d", path)
        //drawing legend for chloropleth
          var w = 960, h = 625; //width and height of legend 

          var key = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h)
            .attr("class", "legend");

          var legend = key.append("defs")
            .append("svg:linearGradient")
            .attr("id", "gradient")
            .attr("x1", "100%")
            .attr("y1", "100%")
            .attr("x2", "0%") //for the start opacity 0 to be at the left of x 
            .attr("y2", "100%")
            .attr("spreadMethod", "pad");
          //stop color
          legend.append("stop")
            .attr("offset", "0%")
            .attr("stop-color", highColorPace)
            .attr("stop-opacity", 1);
          //start color
          legend.append("stop")
            .attr("offset", "100%")
            .attr("stop-color", lowColor)
            .attr("stop-opacity", 1);

          key.append("rect")
            .attr("width", 200) //width and height of rectangle 
            .attr("height", 20)
            .style("fill", "url(#gradient)")
            .attr("transform", "translate(220, 570)"); //changes the position
          
          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 220) 
            .attr("y", 605) 
            .text("Low");

          key.append("text")
            .attr("class", "legendText") 
            .attr("x", 390) 
            .attr("y", 605) 
            .text("High");

          key.append("text")
            .attr("class", "legendHeading")
            .attr("x", 220)
            .attr("y", 560) 
            .text("Relative Frequency")

          //adding source
          key.append("text")
            .attr("class", "sourceText")
            .attr("x", 220)
            .attr("y", 618) 
            .text("SOURCE: Department of City Planning (2017), Inside AirBnB (2017)")
      }
};
  </script>   

</html>